Kiro Agent Steering（权责清晰版）
===============================

本文件只定义“工作流如何推进”。
- Steering 负责：定义循环步骤、每一步要产出的工件、以及允许改动的边界。
- Hook 负责：在 `predict.py` 结果出来后进行验收，并重新拉起本 Steering 的循环。


一、任务与验收
------------
- 任务：仅基于 DNA 序列信息做 E/P 互作预测。
- 目标：未见细胞系鲁棒性。
- 验收阈值：domain-kl/test 与各细胞系 AUPR ≥ 0.75。


二、循环步骤（每轮 n→n+1）
---------------------

Step 1：阅读与对齐
- 读：`docx/基线结果.log`、`docx/历史索引.md`、最新记录点的反思/方案。
- 产出：明确当前记录点编号 n 与本轮唯一目标（AUPR≥0.75）。

Step 2：差距分析
- 读：`log/记录点n训练日志.log`、`log/记录点n预测结果.txt`（若存在）。
- 产出：差距清单（距离 0.75 还有多少）与失败模式（例如 Recall≈1/Precision 低、模式坍缩、推理断裂）。

Step 3：写反思（记录点 n）
- 写：`docx/记录点n/记录点n反思.md`。
- 要求：只写可验证的根因，必须能导出下一步“可检验假设”。

Step 4：写方案（记录点 n+1）
- 写：`docx/记录点(n+1)/记录点(n+1)方案.md`。

Step 5：更新历史索引
- 写：`docx/历史索引.md` 追加记录点 n+1 条目（结构改动、要解决的问题、成功/失败标准）。

Step 6：实现方案（代码修改）
- 改：`models/PRISMModel.py`、`models/layers/distill.py`、`PRISM.py`、`predict.py`（仅限方案涉及范围）。

Step 7：提交与推送（训练前）
- 代码提交以后、训练以前：执行 `git push origin plan15-C`。

Step 8：实验
- 跑：`PRISM.py`（长耗时）。
- 产出：`log/记录点(n+1)训练日志.log`。

Step 10：交由 Hook 验收并拉起下一轮
- 由 `workflow/kiro_agent_hooks.md` 根据 Step 9 的结果决定：达标收敛验证 / 不达标继续迭代。


三、达标后流程（稳定性验证）
------------------------
- 达标后不做结构性大改。
- 只做：复现实验、随机种子稳定性、日志与记录补齐、小修复。

