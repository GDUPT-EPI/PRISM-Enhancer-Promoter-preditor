# 技术栈

## 核心框架
- **PyTorch**: 主要深度学习框架
- **Python 3.x**: 主要编程语言
- **CUDA**: GPU加速支持

## 关键依赖
- **NumPy**: 数值计算
- **Pandas**: 数据处理和CSV文件操作
- **Scikit-learn**: 评估指标(AUPR, AUC, F1, 精确率, 召回率)
- **Matplotlib**: 可视化和绘图
- **tqdm**: 进度条显示
- **XML**: 细胞类型配置解析

## 模型架构组件
- **自定义DNA嵌入**: 6-mer K-mer分词和词汇表
- **CNN层**: 1D卷积进行序列特征提取
- **Transformer组件**: 多头注意力机制配合RoPE(旋转位置编码)
- **CBAT模块**: 卷积块注意力Transformer
- **FourierKAN**: 基于傅里叶的Kolmogorov-Arnold网络用于能量建模

## 数据处理
- **K-mer分词**: 6-mer DNA序列编码
- **序列填充**: 动态填充配合注意力掩码
- **批次采样**: 细胞系感知的自定义采样器
- **缓存系统**: PyTorch张量缓存在`_cache/`目录

## 配置管理
- **集中配置**: 所有参数在`config.py`中
- **无命令行参数**: 仅通过文件修改配置
- **环境变量**: 设备选择(CUDA/CPU)

## 常用命令

### 训练
```bash
python PRISM.py
```

### 预测/评估
```bash
python predict.py
```

### 快速执行 训练+预测
```bash
bash run.sh 
```

## 开发模式
- **相对路径**: 所有路径相对于项目根目录
- **日志记录**: 全面的日志记录到`log/`目录
- **检查点**: 自动模型保存和epoch跟踪
- **非严格加载**: 灵活的检查点加载支持模型演进

## 性能考虑
- **批次大小**: 可配置(PRISM默认64)
- **工作线程**: 多线程数据加载(默认4)
- **内存管理**: 固定内存用于GPU传输
- **梯度裁剪**: 防止梯度爆炸(最大范数0.8)

## 关键技术特点
- **域对抗训练**: 使用梯度反转层(GRL)实现细胞系泛化
- **能量耗散系统**: U_I(内势) - R_E(环境阻抗)的物理启发框架
- **正交解耦**: z_I ⊥ z_F 确保共性和特异性特征分离
- **自适应损失**: 结合基础损失、自适应注意力损失、投机惩罚等