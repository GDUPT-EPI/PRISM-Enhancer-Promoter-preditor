**历史经验记录（上次修复与反思）**
- 修复记录点1：将原始 cross attn 替换为 CBAT（含二维重排与块因果掩码、硬 Top‑k、自适应损失），并在 `PRISMBackbone` 中合并 `[P;E]` 输入以实现 `E←P`，掩码屏蔽 `E→E`。
- 上次问题：
  - 硬 Top‑k 导致未选 token 输出为零，排名断裂，AUPR/AUC下滑。
  - 二维重排引入网格化假设与硬边界，损害序列语义与长程对齐。
  - 门控饱和（Sigmoid靠近0/1）使概率整体上移，Recall↑ Precision↓。
  - 仅单向 `E←P` 缺少补偿，跨域稳健性不足。
- 上次结论：需要替代2D重排、软化稀疏、门控温控、小残差、锚点引导与双向协同，以提升未见细胞上的排序稳健性与AUPR/AUC。

**本次修复与反思（新增记录）**
- 修复记录点2：
  - 用一维多尺度卷积金字塔替代二维重排，输出保持 `[B,L,D]`。
  - `RoPE_CausalBlockAttention` 增加 `use_block_mask/window_size`，默认窗口掩码，弱化硬边界。
  - `RoPE_AdaptAttention` 改为温度软稀疏（列偏置），不再零填未选列，保留排序连续性。
  - `gate_1/gate_2` 加入温度控制与小系数残差，抑制概率上移。
  - `PRISMBackbone` 在池化处引入 `P` 的锚点温度，降低峰值放大。
- 本次结果：在若干细胞系上 AUPR/AUC 较旧版上升、与 cross attn 接近或略低；Recall回落、Precision上升，F1与 cross attn 接近。
- 反思：仍需加强全局对齐通道、引入双向协同与锚点参与注意力、进一步约束门控与稀疏，以在未见细胞上提升排序稳健性并超过 cross attn。